<h2>My account</h2>
<a class="text-monospace" href="http://localhost:3000/myaccount"></a>
<br>
Welcome to my account page. You will see your idea and how many participants you have in your idea.

<ul class="navbar-nav">
    <li class="nav-item">
        <a class="btn btn-outline-success" href="/idea">Create an Idea</a>
    </li>
</ul>
<br>
<br>
<a type="button" class="btn btn-light" onclick="history.back()">Back</a>
<a type="button" class="btn btn-light" onclick="location.reload(true)">Refresh</a>
<a type="button" class="btn btn-light" onclick="location.href='http://localhost:3000'">Go to Main</a>

<br>
<br>
<div class="card">
    {{#each ideas }}
    <div class="card-header">
        {{ id }} : {{ this.summary }}
    </div>
    <div class="card-body" id="{{ thiis.id }}">
        <h5 class="card-title">Limit of Participants :{{ this.numberOfParticipant }}</h5>
        <p class="card-text">Description : <br>
        {{ this.description }} <br>
        Participants:
        {{ this.participants}}
        </p>
        <p>
            <a href="/analysis/{{ this.id }}" class="btn btn-outline-danger">[ANALYSIS]</a>
            <a href="/edit/{{ this.id }}" class="btn btn-outline-warning">[EDIT]</a>
            <a href="/delete/{{ this.id }}" class="btn btn-outline-secondary delete"
                data-id="{{ this.id }}">[DELETE]</a>

        </p>
        <script>
            document.addEventListener('click', async (e) => {
                if (e.target.className === 'delete') {
                    const animalId = e.target.getAttribute('data-id');
                    console.log(animalId)
                    await deleteAnimal(animalId)
                    const animal = document.getElementById(animalId);
                    animal.parentNode.removeChild(animal);
                };
            });

            async function deleteAnimal(id) {
                let response = await fetch("/delete/" + id);
                let isDeleted = response.json().deleted;

                return isDeleted;
            }
        </script>
        <!--
        <script>
            $(function () {
                $('.btn_vote').click(function () {
                    $(this).toggleClass('on');
                    var id = $(this).attr('id');
                    $(this).hasClass('on') ? Vote(id, 'plus') : Vote(id, 'minus');
                });
            });
            function Vote(id, plus) {
                cls = $('.' + id);
                cls_num = Number(cls.html());
                count = plus == 'minus' ? cls_num - 1 : cls_num + 1;
                $.get('vote.php', { 'file': id, 'count': count }, function () {
                    cls.html(count)
                });
            }
        </script>
        -->
        <button id='increment'></button>
        <div id='count'> {{ counter }}</div>
        <script src='/lib/axios/axios.min.js'></script>
        <script>
            document.getElementById('increment').addEventListener('click', updateCounter);

            async function updateCounter() {
                const url = '/api/increment';
                let response = await axios.get(url);
                let counterObj = response.data;
                document.getElementById('count').innerText = counterObj.counter;

            }
        </script>

    </div>
    {{/each}}
    </dir>